/**
 * TOTP auto-refresh JavaScript module
 *
 * @module     local_totp/totp_refresh
 * @copyright  2025, Lo√Øc CRAMPON <loic.crampon@gmail.com>
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("local_totp/totp_refresh",["jquery","core/ajax"],(function($,Ajax){var courseId=0,period=30,circumference=691,remainingSeconds=0,countdown=function(){var offset;--remainingSeconds<0?(remainingSeconds=period,Ajax.call([{methodname:"local_totp_get_totp",args:{courseid:courseId}}])[0].done((function(response){$("#totp-code").text(response.totp),remainingSeconds=response.remaining,$("#totp-remaining").text(remainingSeconds);var $circle=$("#totp-progress-circle");$circle.css("transition","none"),$circle.css("stroke-dashoffset",0),setTimeout((function(){$circle.css("transition","stroke-dashoffset 1s linear")}),50)})).fail((function(ex){console.error("Failed to refresh TOTP:",ex)}))):($("#totp-remaining").text(remainingSeconds),offset=circumference-remainingSeconds/period*circumference,$("#totp-progress-circle").css("stroke-dashoffset",offset))};return{init:function(cid,p,circ){courseId=cid,period=p,circumference=circ,remainingSeconds=parseInt($("#totp-remaining").text()),setInterval(countdown,1e3)}}}));

//# sourceMappingURL=totp_refresh.min.js.map